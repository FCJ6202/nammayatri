@bap-dashboard-host = http://localhost:8017

# @name healthcheck
GET {{bap-dashboard-host}}

###

# use this creds for testing different roles:
# name = customer, driver, juspay_ops, juspay_admin, customer_service
# email = name@dashboard.com, password = name

# @name login

POST {{bap-dashboard-host}}/dashboard/login
content-type: application/json

{
  "email" : "juspay_admin@dashboard.com",
  "password" : "juspay_admin",
  "serverName" : "APP_BACKEND_YATRI"
}

###

# @name personList

@token = {{login.response.body.authToken}}

GET {{bap-dashboard-host}}/dashboard/admin/person/list
  ?limit=10
  &offset=0
  # &searchString=customer
  # &searchString=7777777781
content-type: application/json
token: {{token}}

###

# @name getAccessMatrix

GET {{bap-dashboard-host}}/dashboard/admin/accessMatrix
  ?limit=10
  &offset=0
content-type: application/json
token: {{token}}

###

# @name getAccessMatrixByRole

@roleId = {{getAccessMatrix.response.body.accessMatrix[0].role.id}}

GET {{bap-dashboard-host}}/dashboard/admin/accessMatrix/role/{{roleId}}
content-type: application/json
token: {{token}}

###

# @name createRole

POST {{bap-dashboard-host}}/dashboard/admin/roles/create
content-type: application/json
token: {{token}}

{ "name" : "DEVELOPER",
  "description" : "developer"
}

###

# @name assignRole

# assign new "DEVELOPER" role to person with name "customer"
@personId = {{personList.response.body.list[0].id}}

@developerRoleId = {{createRole.response.body.id}}

POST {{bap-dashboard-host}}/dashboard/admin/person/{{personId}}/assignRole/{{developerRoleId}}
content-type: application/json
token: {{token}}

###

# @name assignAccessLevel

POST {{bap-dashboard-host}}/dashboard/admin/roles/{{developerRoleId}}/assignAccessLevel
content-type: application/json
token: {{token}}

{ "apiEntity" : "CUSTOMERS",
  "userAccessType" : "USER_FULL_ACCESS"
}

###

# @name assignServerAccess

POST {{bap-dashboard-host}}/dashboard/admin/person/{{personId}}/assignServerAccess
content-type: application/json
token: {{token}}

{
  "serverName" : "APP_BACKEND_ARDU"
}

###

# @name profile

@customerToken = 512e0a7b-e521-4d6b-a0c4-8713ae345bf2

GET {{bap-dashboard-host}}/dashboard/person/profile
content-type: application/json
token: {{customerToken}}

###

# separate login for another server

# @name arduCustomerLogin

POST {{bap-dashboard-host}}/dashboard/login
content-type: application/json

{
  "email" : "customer@dashboard.com",
  "password" : "customer",
  "serverName" : "APP_BACKEND_ARDU"
}

###

# @name getCurrentServer

@arduCustomerToken = {{arduCustomerLogin.response.body.authToken}}

GET {{bap-dashboard-host}}/dashboard/person/getCurrentServer
content-type: application/json
token: {{arduCustomerToken}}

###

# check access level for new role "DEVELOPER"

# @name customerList

GET {{bap-dashboard-host}}/bap/ardu/customer/list
content-type: application/json
token: {{arduCustomerToken}}

###

# @name logout

POST {{bap-dashboard-host}}/dashboard/logout
content-type: application/json
token: {{token}}
