imports:
  VehicleCategory: BecknV2.FRFS.Enums
  FilePath: EulerHS.Prelude

module: MultiModal

types:
  FileFormat:
    enum: "GTFS,JSON,CSV"
  RawDataType:
    enum: "GTFS_DATA,FARE_DATA"
  StageInfo:
    - stageName: Text
    - stageStatus: StageStatus
  PreprocessFRFSDataResp:
    - versionId: Text
    - versionTag: Int
  FRFSDataStatusResp:
    - versionId: Text
    - status: [StageInfo]
  ReadyVersionsResp:
    - readyVersions: [PreprocessFRFSDataResp]
  StageStatus:
    enum: "INPROGRESS,COMPLETED,FAILED"
  PreprocessFRFSDataReq: # city inferred from api path variable
    - vehicleType: VehicleCategory
    - fileFormat: FileFormat
    - file: FilePath
    - inputDataType: RawDataType
    - derive: "'HideSecrets"
  FRFSDataStatusReq:
    - versionId: Text
    - operatingCityId: Text
    - vehicleType: VehicleCategory
    - derive: "'HideSecrets"
  ReadyVersionReq:
    - cityId: Text
    - vehicleType: VehicleCategory
    - derive: "'HideSecrets"
  ApplyVersionReq:
    - cityId: Text
    - vehicleType: VehicleCategory
    - versionId: Text
    - versionTag: Text
    - rolloutPercent: Int
    - derive: "'HideSecrets"

apis:
  - POST: # PreprocessFRFSDataAPI
      endpoint: multimodal/frfs/data/preprocess
      auth: ApiAuthV2
      request:
        type: PreprocessFRFSDataReq
      response:
          type: PreprocessFRFSDataResp

  - POST: # StatusCheckFRFSDataAPI
      endpoint: multimodal/frfs/data/status
      auth: ApiAuthV2
      request:
        type: FRFSDataStatusReq
      response:
          type: FRFSDataStatusResp

  - POST: # GetReadyVersionsAPI
      endpoint: multimodal/frfs/data/version/isReady
      auth: ApiAuthV2
      request:
        type: ReadyVersionReq
      response:
        type: ReadyVersionsResp

  - POST: # ApplyReadyVersionsAPI
      endpoint: multimodal/frfs/data/version/apply
      auth: ApiAuthV2
      request:
        type: ApplyVersionReq
      response:
        type: APISuccess